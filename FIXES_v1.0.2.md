# Web Page Scorer v1.0.2 Fixes and Enhancements

## 🔧 Bug Fixes

### 1. 修复预加载逻辑错误
**问题**: 原始代码尝试从索引0开始加载，但Excel数据的第0行是标题行，导致反复尝试加载空URL
**修复**: 
- 更新 `currentIndex` 从1开始，跳过标题行
- 在URL加载前增加验证：`url && url.trim() && url.startsWith('http')`
- 修复页面索引计算逻辑

**影响**: 消除了日志中的 `ERR_INVALID_URL (-300)` 错误

### 2. 预加载性能优化
**问题**: 固定预加载10页会在数据量大时造成卡顿
**修复**:
- 添加可配置的预加载页数设置 (0, 3, 5, 10, 15页)
- 增加预加载间隔从100ms到200ms，减少CPU占用
- 添加URL有效性检查，避免无效预加载

## ✨ 新功能

### 1. 预加载页数设置
- **位置**: 设置面板 → "Preload pages" 下拉菜单
- **选项**: 禁用、3页、5页、10页、15页
- **默认值**: 5页（平衡性能和用户体验）
- **实时生效**: 更改设置后立即重新开始预加载

### 2. 页码跳转功能
- **位置**: 设置面板 → "Jump to page" 输入框
- **功能**: 
  - 数字输入框，支持直接输入页码
  - "Go" 按钮或回车键跳转
  - 自动范围验证 (1 到最大页数)
  - 输入无效页码时显示错误并恢复当前页码
- **自动更新**: 导航时输入框自动显示当前页码

### 3. 改进的错误处理
- **URL验证**: 只加载以 "http" 开头的有效URL
- **用户友好错误**: 清晰的错误消息，区分无效URL和加载失败
- **控制台日志**: 预加载成功/失败的详细日志记录

## 🎛️ 用户界面改进

### 设置面板扩展
```
⚙️ Settings
├── Auto-advance on Pass (toggle)
├── Preload pages: [dropdown] 
├── Jump to page: [input] [Go button]
├── Preloading status
└── Keyboard shortcuts guide
```

### 预加载状态显示
- "Preloading disabled" - 当设置为0页时
- "Preloading X pages..." - 正在预加载时
- "X pages preloaded" - 预加载完成时

## 📊 性能影响

### 内存使用
- **优化前**: 固定预加载10页，可能造成内存压力
- **优化后**: 用户可选择0-15页，默认5页减少内存占用

### CPU使用
- **优化前**: 100ms间隔，较为激进
- **优化后**: 200ms间隔，减少CPU峰值

### 用户体验
- **错误减少**: 消除无效URL加载错误
- **响应性**: 用户可以根据设备性能调整预加载
- **导航效率**: 页码跳转功能支持快速定位

## 🔄 向后兼容性

- **Excel文件**: 完全兼容现有数据文件
- **快捷键**: 保持不变
- **设置**: 新设置使用合理默认值
- **数据格式**: 保持1/0格式不变

## 🧪 测试建议

1. **预加载测试**: 尝试不同的预加载页数设置，观察性能变化
2. **页码跳转**: 测试有效/无效页码输入
3. **错误处理**: 尝试加载包含无效URL的Excel文件
4. **内存使用**: 长时间使用后检查内存使用情况

## 📝 用户操作指南

### 调整预加载设置
1. 在右侧设置面板找到 "Preload pages"
2. 根据设备性能选择合适的页数
3. 性能较弱的设备建议选择3页或禁用
4. 性能较强的设备可以选择10-15页

### 使用页码跳转
1. 在 "Jump to page" 输入框输入目标页码
2. 点击 "Go" 按钮或按回车键
3. 如果页码无效，会显示错误消息并恢复当前页码

### 监控预加载状态
- 观察设置面板中的预加载状态信息
- 控制台日志显示详细的预加载信息（开发模式） 