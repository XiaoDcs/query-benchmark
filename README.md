# 🚀 Web Page Scorer 

一个功能强大的网页评分桌面应用，专为从 Excel 文件中高效批量评估网页而设计。

当前版本：v1.0.4

## 🚀 快速开始

### 📥 获取样例Excel模板

1. **启动应用**后，点击顶部的 `📥 Download Sample Excel` 按钮
2. **保存模板**到您希望的位置（如：`my_web_pages.xlsx`）
3. **编辑模板**，填入您的网页评分数据
4. **加载文件**，点击 `📁 Select Excel File` 选择您编辑好的Excel文件

### 🎯 典型使用场景

#### 📰 内容质量评估
- **新闻文章审核**: 评估新闻内容的准确性、客观性和质量
- **博客文章筛选**: 筛选高质量的博客内容进行推荐
- **教育资源评估**: 评估在线教育内容的适用性和质量

#### 🔍 搜索结果质量控制
- **搜索引擎优化**: 评估搜索结果页面的相关性和质量
- **推荐系统训练**: 为推荐算法提供人工评分训练数据
- **广告内容审核**: 审核广告落地页的合规性和质量

#### 📊 市场研究与竞品分析
- **竞品网站分析**: 批量评估竞争对手的网站质量和用户体验
- **行业标准制定**: 建立特定行业的网页质量评估标准
- **用户体验研究**: 评估不同类型网页的用户体验表现

#### 🏢 企业内部审核
- **公司网站审计**: 定期审核公司各产品页面的质量
- **供应商网站评估**: 评估合作伙伴网站的专业性和可信度
- **品牌形象监控**: 监控品牌相关网页内容的质量和一致性

## ✨ 主要功能

- **📊 Excel 集成**: 动态选择和处理 Excel 文件，自动识别列结构
- **🌐 内嵌浏览器**: 使用 Electron BrowserView 直接查看网页内容
- **⚡ 智能评分**: 支持 Pass/Fail 快速评分，完全自定义快捷键系统
- **🏷️ 高级标签系统**: 7个可编辑预设标签 + 无限自定义标签
- **📸 智能截图**: 一键截图并自动保存，避免 Excel 字符限制
- **📝 实时备注**: 问题输入框支持实时编辑和自动保存
- **💾 智能保存**: 多时机自动保存，确保数据安全
- **⌨️ 完全自定义快捷键**: 11个功能的快捷键完全可定制
- **🎯 用户友好**: 紧凑布局，一屏操作，响应式设计

## 📸 界面预览

![Web Page Scorer v1.0.3 界面预览](img/screenshot_v1.0.3.png)  

## 🔧 技术栈

- **Electron**: 跨平台桌面应用框架
- **Node.js**: 后端逻辑处理
- **XLSX**: Excel 文件读写
- **HTML/CSS/JavaScript**: 前端界面
- **Electron Builder**: 应用打包工具

## 📦 安装包下载

### 🍎 Mac 版本

#### Intel Mac (x64):
- **ZIP 压缩包**: `Web Page Scorer-1.0.3-mac.zip` (~102MB)

#### Apple Silicon Mac (M1/M2/M3):
- **ZIP 压缩包**: `Web Page Scorer-1.0.3-arm64-mac.zip` (~95MB)

> 💡 **新版本说明**: 从v1.0.3开始，我们提供更轻量级的ZIP格式分发，安装更简便，兼容性更好！

### 🪟 Windows 版本

- **安装程序**: `Web Page Scorer Setup 1.0.3.exe` (~146MB)
- **便携版**: `Web Page Scorer 1.0.3.exe` (~146MB)

> 📋 详细安装说明请查看 [doc/RELEASE_NOTES_v1.0.3.md](doc/RELEASE_NOTES_v1.0.3.md)

## 🛠️ 开发环境设置

### 环境要求
- Node.js 16+
- npm 或 yarn

### 安装步骤

1. **克隆项目**
```bash
git clone https://github.com/XiaoDcs/web-page-scorer.git
cd web-page-scorer
```

2. **安装依赖**
```bash
npm install
```

3. **开发模式运行**
```bash
npm start
```

4. **构建应用**
```bash
# 构建所有平台
npm run build:all

# 仅构建 Mac 版本
npm run build:mac

# 仅构建 Windows 版本
npm run build:win

# 使用构建脚本（推荐）
./script/build.sh          # Mac/Linux
script/build.bat           # Windows
```

## 📂 项目结构

```
web-page-scorer/
├── main.js                    # Electron 主进程
├── index.html                 # 应用界面
├── package.json               # 项目配置
├── README.md                  # 项目说明
├── doc/                       # 文档目录
│   ├── CHANGELOG.md           # 更新日志
│   ├── RELEASE.md             # 发布说明
│   ├── HOW_TO_RELEASE.md      # 发布指南
│   ├── FIXES_v1.0.2.md        # 修复记录
│   ├── RELEASE_NOTES.md       # 发布说明
│   ├── RELEASE_NOTES_v1.0.1.md # v1.0.1发布说明
│   └── RELEASE_SUMMARY_v1.0.2.md # v1.0.2发布总结
├── script/                    # 脚本目录
│   ├── build.sh               # Mac/Linux 构建脚本
│   ├── build.bat              # Windows 构建脚本
│   ├── create_sample_excel.js # 创建样例Excel文件脚本
│   └── prepare-release.sh     # 发布准备脚本
├── test_data/                 # 测试数据目录
│   └── test_link.xlsx         # 测试用Excel文件
├── dist/                      # 构建输出目录
├── screenshots/               # 截图存储目录
├── assets/                    # 资源文件目录
├── public/                    # 公共文件目录
│   └── sample_template.xlsx   # 样例Excel模板文件
├── src/                       # 源代码目录
└── node_modules/              # 依赖包
```

## 🎯 使用方法

### 📚 完整工作流程

#### 1️⃣ 准备数据文件
- **获取模板**: 启动应用，点击 `📥 Download Sample Excel` 下载样例模板
- **编辑数据**: 在Excel中填入您需要评分的网页信息
  - `description`: 填写网页描述（如："产品介绍页面"）
  - `link`: 填写完整的网页URL
  - `thumbnail_link`: （可选）填写缩略图链接
- **保存文件**: 保存为 `.xlsx` 格式

#### 2️⃣ 加载文件并开始评分
- **选择文件**: 点击 `📁 Select Excel File` 选择您准备的Excel文件
- **开始浏览**: 应用自动加载第一个网页，右侧显示页面信息
- **评分操作**: 
  - 查看内嵌浏览器中的网页内容
  - 使用 `✅ Pass` 或 `❌ Fail` 按钮评分
  - 或使用快捷键：`↑` 通过，`↓` 失败

#### 3️⃣ 添加详细评估信息
- **问题标签**: 点击预设标签或添加自定义标签
  - 预设标签：有争议性、涉及敏感话题等
  - 自定义标签：双击编辑，右键删除
  - 快捷键：`Ctrl+1~9` 快速添加标签
- **截图记录**: 点击 `📸 Screenshot` 保存当前页面截图
- **备注说明**: 在文本框中添加详细的问题描述

#### 4️⃣ 导航和保存
- **页面切换**: 
  - 点击 `← Previous` / `Next →` 按钮
  - 使用方向键 `←` / `→` 快速切换
  - 设置中启用"Auto-advance on Pass"自动跳转
- **批量跳转**: 在设置面板使用"Jump to page"功能
- **自动保存**: 应用自动保存评分结果到Excel文件
- **手动保存**: 按 `Ctrl+S` 或点击 `💾 Save` 手动保存

#### 5️⃣ 高级功能使用
- **自定义快捷键**: 点击 `⌨️ Custom Shortcuts` 配置个性化快捷键
- **预加载优化**: 在设置中调整预加载页面数量提升性能
- **外部浏览器**: 点击 `🔗 Open in Browser` 在系统浏览器中查看
- **全屏截图**: 点击缩略图可以全屏查看

### 💡 效率提升技巧

#### ⚡ 快速评分流程
1. 启用"Auto-advance on Pass"自动跳转功能
2. 对于明显合格的页面直接按 `↑` 键通过
3. 对于有问题的页面使用 `Ctrl+数字` 快速添加标签
4. 使用预加载功能减少页面加载等待时间

#### 🎯 精确问题记录
1. 使用预设标签快速分类常见问题
2. 自定义标签记录特定项目的专门问题
3. 文本备注添加详细的问题描述和建议
4. 截图功能保存视觉证据

#### 📊 批量处理优化
1. 合理设置预加载数量（建议5-10页）
2. 使用页面跳转功能快速定位
3. 定期手动保存避免数据丢失
4. 合理安排工作批次避免疲劳评分

## ⌨️ 默认快捷键

| 功能 | 默认快捷键 | 说明 |
|------|-----------|------|
| 前一页 | `←` | 导航到上一个网页 |
| 后一页 | `→` | 导航到下一个网页 |
| 标记通过 | `↑` | 评分为通过 (1) |
| 标记失败 | `↓` | 评分为失败 (0) |
| 手动保存 | `Ctrl+S` | 立即保存到Excel |
| 截图 | `Ctrl+P` | 对当前页面截图 |
| 重新加载 | `F5` | 重新加载当前网页 |
| 外部打开 | `Ctrl+O` | 在系统浏览器中打开 |
| 清除标签 | `Ctrl+0` | 清空issue备注 |
| 自动跳转开关 | `Ctrl+A` | 切换Pass后自动跳转 |
| 页面跳转 | `Ctrl+G` | 跳转到指定页面 |
| 快速标签 | `Ctrl+1~9` | 快速应用预设/自定义标签 |

> 💡 **所有快捷键均可自定义！** 在设置面板中点击"⌨️ Custom Shortcuts"进行个性化配置

## 🏷️ 标签系统

### 预设标签 (可编辑)
1. 有争议性
2. 涉及敏感话题
3. 过于主观评价
4. 负面语言
5. 过于标题党
6. 挑战政策/制度
7. 图片无法加载

### 自定义标签功能
- **添加标签**: 点击 "+ Add Tag" 按钮
- **编辑标签**: 双击任意标签进行编辑
- **删除标签**: 右键点击自定义标签删除
- **快捷键**: 前9个标签自动获得 Ctrl+1~9 快捷键
- **持久化**: 所有标签更改自动保存到本地

## 📊 Excel 文件格式

### 📋 必需列结构

| 列名 | 数据类型 | 是否必填 | 说明 | 示例 |
|------|---------|----------|------|------|
| `description` 或 `query` | 文本 | ✅ 必填 | 网页描述或查询内容 | "科技新闻报道" |
| `link` | URL | ✅ 必填 | 目标网页链接 | "https://www.example.com/news" |
| `thumbnail_link` | URL | ⚪ 可选 | 缩略图链接 | "https://img.example.com/thumb.jpg" |
| `result` | 数字 | 🤖 系统填写 | 评分结果 (0=失败, 1=通过) | `1` |
| `issue` | 文本 | 🤖 系统填写 | 问题标签和备注 | "有争议性; 自定义备注" |
| `screenshot` | 路径 | 🤖 系统填写 | 截图文件相对路径 | "screenshots/xxx.png" |

### 📝 Excel 数据示例

```
| description     | link                           | thumbnail_link              | result | issue | screenshot |
|----------------|--------------------------------|-----------------------------|--------|-------|------------|
| 科技新闻报道      | https://www.example.com/tech   | https://img.example.com/1   |        |       |            |
| 产品评测文章      | https://www.example.com/review | https://img.example.com/2   |        |       |            |
| 教育资源页面      | https://www.example.com/edu    | https://img.example.com/3   |        |       |            |
```

### 🔧 Excel 配置最佳实践

#### ✅ 推荐做法
- **标题行必须**: 第一行为列标题，应用会自动识别
- **链接完整性**: 确保所有链接都是完整的URL（包含 http:// 或 https://）
- **数据一致性**: 保持每行数据格式的一致性
- **文件编码**: 使用UTF-8编码支持中文内容

#### ⚠️ 注意事项
- **列名灵活**: 系统支持多种列名变体（如：description/query、image/thumbnail等）
- **空值处理**: 评分相关列（result、issue、screenshot）可以为空，系统会自动填充
- **路径相对性**: 截图路径会自动保存为相对路径，便于文件迁移

#### 🚫 避免问题
- 不要在链接列中包含非URL内容
- 不要手动修改result列的数值格式
- 避免在description列中使用过长的文本（建议<200字符）

### 📥 获取样例模板

在应用中点击 `📥 Download Sample Excel` 按钮即可获取包含示例数据的模板文件，您可以基于此模板快速开始您的网页评分工作。

## 🚀 v1.0.3 新功能亮点

### 🔧 全局快捷键系统增强
- **真正的全局快捷键**: 无论焦点在何处，快捷键都能正常工作
- **修复焦点问题**: 解决了网页获得焦点时快捷键失效的问题
- **改进键盘事件处理**: 更可靠的全局键盘事件捕获机制
- **完全无缝操作**: 点击网页后无需重新点击面板即可使用快捷键

### 🖼️ 缩略图预览优化
- **解决覆盖问题**: 修复全屏预览被网页组件覆盖的z-index问题
- **智能显示控制**: 点击缩略图时自动隐藏BrowserView确保清晰显示
- **更好的用户体验**: 缩略图查看更流畅，不再被遮挡

### ⚡ 性能与体验提升
- **更稳定的构建**: 优化了构建流程，解决了DMG创建问题
- **轻量化分发**: 改用ZIP格式分发，安装更简便，体积更小
- **改进的UI响应性**: 提升了界面的响应速度和可用性
- **跨平台兼容性**: 更好的macOS和Windows兼容性

### 🔑 完整快捷键支持
- **⬆️ 上箭头**: 标记为通过 (Pass) - 现在全局有效
- **⬇️ 下箭头**: 标记为不通过 (Fail) - 现在全局有效  
- **Ctrl/⌘ + S**: 保存当前进度 - 现在全局有效
- **Ctrl/⌘ + R**: 重新加载当前网页 - 现在全局有效
- **Ctrl/⌘ + ←/→**: 上一页/下一页 - 现在全局有效
- **1-9**: 快速添加对应标签 - 现在全局有效

### 📄 分发格式优化
- **移除DMG格式**: 解决了GitHub Actions构建中的权限问题
- **专注ZIP分发**: 更快的下载速度，更好的兼容性
- **简化安装流程**: 用户只需解压即可使用，无需复杂安装步骤

### 🛠️ 开发与构建改进
- **修复构建配置**: 解决了screenshots目录和DMG背景图像问题
- **优化CI/CD**: GitHub Actions现在能稳定构建和发布
- **环境变量优化**: 防止electron-builder自动发布冲突

## 🧪 测试

项目已通过以下测试：
- ✅ Mac (Intel/Apple Silicon) 打包测试
- ✅ Windows (x64/x86) 打包测试
- ✅ Excel 文件读写测试
- ✅ 自动保存功能测试
- ✅ 截图功能测试
- ✅ 自定义快捷键测试
- ✅ 标签系统测试
- ✅ 响应式布局测试

## 🛠️ 构建配置

使用 `electron-builder` 进行跨平台打包：

- **Mac**: 生成 DMG 和 ZIP 格式，支持 Intel 和 Apple Silicon
- **Windows**: 生成 NSIS 安装程序和便携版
- **代码签名**: 支持 Mac 代码签名（需配置证书）
- **自动更新**: 预留更新机制接口

## 📄 许可证

MIT License

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

---

**版本**: 1.0.3  
**最后更新**: 2025年5月27日 

## 📖 相关文档

- **📋 详细用户指南**: [doc/USER_GUIDE.md](doc/USER_GUIDE.md) - 完整的使用教程和最佳实践
- **🔄 版本更新日志**: [doc/RELEASE_NOTES_v1.0.3.md](doc/RELEASE_NOTES_v1.0.3.md) - v1.0.3详细更新内容  
- **🛠️ 发布指南**: [doc/HOW_TO_RELEASE.md](doc/HOW_TO_RELEASE.md) - 开发者发布说明

### 🔄 版本历史

- **v1.0.3** (2025-05-27): 全局快捷键系统增强 + 缩略图预览优化 + 构建流程改进
- **v1.0.2** (2025-05-27): 完全自定义快捷键系统 + 高级标签管理
- **v1.0.1** (2024-05-26): 智能预加载 + 自动跳转功能
- **v1.0.0** (2024-05-26): 初始发布版本

> 📋 完整更新日志请查看 [doc/RELEASE_NOTES_v1.0.3.md](doc/RELEASE_NOTES_v1.0.3.md)