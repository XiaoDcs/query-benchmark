# 🚀 Web Page Scorer v1.0.3 - Advanced Electron Desktop App

一个功能强大的网页评分桌面应用，专为从 Excel 文件中高效批量评估网页而设计。

## ✨ 主要功能

- **📊 Excel 集成**: 动态选择和处理 Excel 文件，自动识别列结构
- **🌐 内嵌浏览器**: 使用 Electron BrowserView 直接查看网页内容
- **⚡ 智能评分**: 支持 Pass/Fail 快速评分，完全自定义快捷键系统
- **🏷️ 高级标签系统**: 7个可编辑预设标签 + 无限自定义标签
- **📸 智能截图**: 一键截图并自动保存，避免 Excel 字符限制
- **📝 实时备注**: 问题输入框支持实时编辑和自动保存
- **💾 智能保存**: 多时机自动保存，确保数据安全
- **⌨️ 完全自定义快捷键**: 11个功能的快捷键完全可定制
- **🎯 用户友好**: 紧凑布局，一屏操作，响应式设计

## 🔧 技术栈

- **Electron**: 跨平台桌面应用框架
- **Node.js**: 后端逻辑处理
- **XLSX**: Excel 文件读写
- **HTML/CSS/JavaScript**: 前端界面
- **Electron Builder**: 应用打包工具

## 📦 安装包下载

### 🍎 Mac 版本

#### Intel Mac (x64):
- **ZIP 压缩包**: `Web Page Scorer-1.0.3-mac.zip` (~102MB)

#### Apple Silicon Mac (M1/M2/M3):
- **ZIP 压缩包**: `Web Page Scorer-1.0.3-arm64-mac.zip` (~95MB)

> 💡 **新版本说明**: 从v1.0.3开始，我们提供更轻量级的ZIP格式分发，安装更简便，兼容性更好！

### 🪟 Windows 版本

- **安装程序**: `Web Page Scorer Setup 1.0.3.exe` (~146MB)
- **便携版**: `Web Page Scorer 1.0.3.exe` (~146MB)

> 📋 详细安装说明请查看 [doc/RELEASE_NOTES_v1.0.3.md](doc/RELEASE_NOTES_v1.0.3.md)

## 🛠️ 开发环境设置

### 环境要求
- Node.js 16+
- npm 或 yarn

### 安装步骤

1. **克隆项目**
```bash
git clone <repository-url>
cd query-benchmark
```

2. **安装依赖**
```bash
npm install
```

3. **开发模式运行**
```bash
npm start
```

4. **构建应用**
```bash
# 构建所有平台
npm run build:all

# 仅构建 Mac 版本
npm run build:mac

# 仅构建 Windows 版本
npm run build:win

# 使用构建脚本（推荐）
./script/build.sh          # Mac/Linux
script/build.bat           # Windows
```

## 📂 项目结构

```
query-benchmark/
├── main.js                    # Electron 主进程
├── index.html                 # 应用界面
├── package.json               # 项目配置
├── README.md                  # 项目说明
├── doc/                       # 文档目录
│   ├── CHANGELOG.md           # 更新日志
│   ├── RELEASE.md             # 发布说明
│   ├── HOW_TO_RELEASE.md      # 发布指南
│   ├── FIXES_v1.0.2.md        # 修复记录
│   ├── RELEASE_NOTES.md       # 发布说明
│   ├── RELEASE_NOTES_v1.0.1.md # v1.0.1发布说明
│   └── RELEASE_SUMMARY_v1.0.2.md # v1.0.2发布总结
├── script/                    # 脚本目录
│   ├── build.sh               # Mac/Linux 构建脚本
│   ├── build.bat              # Windows 构建脚本
│   └── prepare-release.sh     # 发布准备脚本
├── test_data/                 # 测试数据目录
│   └── test_link.xlsx         # 测试用Excel文件
├── dist/                      # 构建输出目录
├── screenshots/               # 截图存储目录
├── assets/                    # 资源文件目录
├── public/                    # 公共文件目录
├── src/                       # 源代码目录
└── node_modules/              # 依赖包
```

## 🎯 使用方法

1. **启动应用**：运行安装包或可执行文件
2. **选择文件**：选择包含网页数据的 Excel 文件
3. **开始评分**：
   - 查看内嵌浏览器中的网页内容
   - 使用快捷键或按钮进行评分
   - 添加问题标签和备注
   - 必要时进行截图
4. **自动保存**：应用会自动保存所有更改到 Excel 文件

## ⌨️ 默认快捷键

| 功能 | 默认快捷键 | 说明 |
|------|-----------|------|
| 前一页 | `←` | 导航到上一个网页 |
| 后一页 | `→` | 导航到下一个网页 |
| 标记通过 | `↑` | 评分为通过 (1) |
| 标记失败 | `↓` | 评分为失败 (0) |
| 手动保存 | `Ctrl+S` | 立即保存到Excel |
| 截图 | `Ctrl+P` | 对当前页面截图 |
| 重新加载 | `F5` | 重新加载当前网页 |
| 外部打开 | `Ctrl+O` | 在系统浏览器中打开 |
| 清除标签 | `Ctrl+0` | 清空issue备注 |
| 自动跳转开关 | `Ctrl+A` | 切换Pass后自动跳转 |
| 页面跳转 | `Ctrl+G` | 跳转到指定页面 |
| 快速标签 | `Ctrl+1~9` | 快速应用预设/自定义标签 |

> 💡 **所有快捷键均可自定义！** 在设置面板中点击"⌨️ Custom Shortcuts"进行个性化配置

## 🏷️ 标签系统

### 预设标签 (可编辑)
1. 有争议性
2. 涉及敏感话题
3. 过于主观评价
4. 负面语言
5. 过于标题党
6. 挑战政策/制度
7. 图片无法加载

### 自定义标签功能
- **添加标签**: 点击 "+ Add Tag" 按钮
- **编辑标签**: 双击任意标签进行编辑
- **删除标签**: 右键点击自定义标签删除
- **快捷键**: 前9个标签自动获得 Ctrl+1~9 快捷键
- **持久化**: 所有标签更改自动保存到本地

## 📊 Excel 文件格式

应用自动识别以下列：
- **description/query**: 描述或查询内容
- **link**: 网页链接
- **thumbnail_link**: 缩略图链接  
- **result**: 评分结果 (0=失败, 1=通过)
- **issue**: 问题备注
- **screenshot**: 截图文件路径

## 🚀 v1.0.3 新功能亮点

### 🔧 全局快捷键系统增强
- **真正的全局快捷键**: 无论焦点在何处，快捷键都能正常工作
- **修复焦点问题**: 解决了网页获得焦点时快捷键失效的问题
- **改进键盘事件处理**: 更可靠的全局键盘事件捕获机制
- **完全无缝操作**: 点击网页后无需重新点击面板即可使用快捷键

### 🖼️ 缩略图预览优化
- **解决覆盖问题**: 修复全屏预览被网页组件覆盖的z-index问题
- **智能显示控制**: 点击缩略图时自动隐藏BrowserView确保清晰显示
- **更好的用户体验**: 缩略图查看更流畅，不再被遮挡

### ⚡ 性能与体验提升
- **更稳定的构建**: 优化了构建流程，解决了DMG创建问题
- **轻量化分发**: 改用ZIP格式分发，安装更简便，体积更小
- **改进的UI响应性**: 提升了界面的响应速度和可用性
- **跨平台兼容性**: 更好的macOS和Windows兼容性

### 🔑 完整快捷键支持
- **⬆️ 上箭头**: 标记为通过 (Pass) - 现在全局有效
- **⬇️ 下箭头**: 标记为不通过 (Fail) - 现在全局有效  
- **Ctrl/⌘ + S**: 保存当前进度 - 现在全局有效
- **Ctrl/⌘ + R**: 重新加载当前网页 - 现在全局有效
- **Ctrl/⌘ + ←/→**: 上一页/下一页 - 现在全局有效
- **1-9**: 快速添加对应标签 - 现在全局有效

### 📦 分发格式优化
- **移除DMG格式**: 解决了GitHub Actions构建中的权限问题
- **专注ZIP分发**: 更快的下载速度，更好的兼容性
- **简化安装流程**: 用户只需解压即可使用，无需复杂安装步骤

### 🛠️ 开发与构建改进
- **修复构建配置**: 解决了screenshots目录和DMG背景图像问题
- **优化CI/CD**: GitHub Actions现在能稳定构建和发布
- **环境变量优化**: 防止electron-builder自动发布冲突

## 🧪 测试

项目已通过以下测试：
- ✅ Mac (Intel/Apple Silicon) 打包测试
- ✅ Windows (x64/x86) 打包测试
- ✅ Excel 文件读写测试
- ✅ 自动保存功能测试
- ✅ 截图功能测试
- ✅ 自定义快捷键测试
- ✅ 标签系统测试
- ✅ 响应式布局测试

## 🛠️ 构建配置

使用 `electron-builder` 进行跨平台打包：

- **Mac**: 生成 DMG 和 ZIP 格式，支持 Intel 和 Apple Silicon
- **Windows**: 生成 NSIS 安装程序和便携版
- **代码签名**: 支持 Mac 代码签名（需配置证书）
- **自动更新**: 预留更新机制接口

## 📄 许可证

MIT License

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

---

**版本**: 1.0.3  
**最后更新**: 2025年5月27日 

### 🔄 版本历史

- **v1.0.3** (2025-05-27): 全局快捷键系统增强 + 缩略图预览优化 + 构建流程改进
- **v1.0.2** (2025-05-27): 完全自定义快捷键系统 + 高级标签管理
- **v1.0.1** (2024-05-26): 智能预加载 + 自动跳转功能
- **v1.0.0** (2024-05-26): 初始发布版本

> 📋 完整更新日志请查看 [doc/RELEASE_NOTES_v1.0.3.md](doc/RELEASE_NOTES_v1.0.3.md)